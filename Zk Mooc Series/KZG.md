# KZG

KZG æ‰¿è¯ºåˆå«åš KZG10 æ‰¿è¯º,æ˜¯ç”± Kate, Zaverucha, and Goldberg ä¸‰ä½ä½œè€…å…±åŒæå‡º.

## **1.å¤šé¡¹å¼è¡¨ç¤º**

å¤šé¡¹å¼ P(x)å¯ä»¥ç”¨ç³»æ•°è¡¨è¿°,å¦‚$p(x)=6x^5+0x^4+0x^3+0x^2+0x^1-55$ç®€å•å¯è¡¨ç¤ºä¸º

$p(x)=6x^5-55$,æ‰€ä»¥å¯¹äºä¸€ä¸ªå¤šé¡¹å¼ P(x)å¯ä»¥è¡¨ç¤ºä¸º$\sum_{0}^{n}c_ix^i$,å…¶ä¸­$c_i$è¡¨ç¤ºå¯¹åº”ä½ç½®çš„ç³»æ•°.

## **2.Commitment Scheme**

### **2.1 Commit Schemes è¿‡ç¨‹ï¼š**

å¯ä»¥æŠŠæ‰¿è¯º C(m)ç†è§£ä¸ºä¸€ä¸ªè£…ç€ä¿¡ä»¶ m çš„ä¿¡å°

![](static/XfBkbAOzwomDgUxqgiicUopRntd.png)

- Setup é˜¶æ®µäº§ç”Ÿä¸€äº›å…¬å…±å‚æ•°
- Commit é˜¶æ®µ:å¯¹æ¶ˆæ¯ **m** è¿›è¡Œæ‰¿è¯ºå¾—åˆ° **C(m)**
- Open é˜¶æ®µ:æ‰“å¼€ **C(m)**å¾—åˆ°** mâ€˜,**éªŒè¯** m**æ˜¯å¦ç­‰äº **mâ€™. commit é˜¶æ®µçš„ mï¼Œåœ¨ open é˜¶æ®µæ˜¯ä¼šæš´éœ²çš„.**

### **2.2 commit Schemes æ€§è´¨ï¼š**

- **Hiding:æ„å‘³ç€æ•Œæ‰‹è·å¾—æ‰¿è¯º c(m)åæ— æ³•è·å¾— m çš„å€¼**

  - computational hiding:å¯¹äºä»»æ„çš„ PPT æ•Œæ‰‹ A.æœ‰
    ![](static/HDjibLSHjoDkj6xG1V8cTC7nnGg.png)
  - Perfect hiding:å°† A çš„è®¡ç®—èƒ½åŠ›ä¿®æ”¹ä¸ºæ— ç©·ç®—åŠ›,â€œâ‰¤ negl(Î»)â€æ›¿æ¢ä¸º 0
- **Binding:æ˜¯æŒ‡ä¸€ä¸ªæ‰¿è¯º c(m) åœ¨ Open é˜¶æ®µæ‰“å¼€åªä¼šå¾—åˆ° m è€Œä¸ä¼šå¾—åˆ° mâ€˜.**

  - computational  Binding
    ![](static/PSBEbWZsUoPlgJx50dKcnhivnOe.png)
  - perfect binding::å°† A çš„è®¡ç®—èƒ½åŠ›ä¿®æ”¹ä¸ºæ— ç©·ç®—åŠ›,â€œâ‰¤ negl(Î»)â€æ›¿æ¢ä¸º 0

### **2.3 Polynomial Commitment Schemesï¼šPCS**

å¤šé¡¹å¼æ‰¿è¯º PCS:æ‰¿è¯ºå¯¹è±¡æ˜¯å•å˜é‡å¤šé¡¹å¼,$f(X)âˆˆF_p^{(â‰¤d)}[X]$:è¡¨ç¤ºæ‰€æœ‰ degree æœ€å¤šä¸º d çš„å•å˜é‡å¤šé¡¹å¼çš„é›†åˆã€‚è¿‡ç¨‹å¯æ€»ç»“å¦‚ä¸‹å›¾

![](static/HXKrbfuUqoksR1xij0HcWyHtncd.png)

- Prover è¿è¡Œ Commit ç®—æ³•,å°†å‡½æ•° f ä¸éšæœºæ•° r ä½œä¸ºè¾“å…¥,$com_f$ä¸ºè¾“å‡º.å°†$com_f$å‘é€ç»™ Verifier
- Verifier å‘é€ä¸€ä¸ªæŒ‘æˆ˜ç‚¹:å³ä¸€ä¸ªå‡½æ•°åŸŸ X ä¸­çš„å…ƒç´  x
- Prover å°† x å¯¹åº”çš„ f(x)=y,ä»¥åŠ proof $\pi$å‘é€ç»™ Verifier.  $\pi$è¡¨æ˜ 1.f(x)=y 2.f å±äº F,å³ f çš„ degree<=d.

å…¶ä¸­ Prover éœ€è¦è®¡ç®—å¦‚ä¸‹å†…å®¹

1. å¤šé¡¹å¼çš„æ‰¿è¯º C=[P(x)]
2. å¤šé¡¹å¼åœ¨ z ç‚¹çš„å€¼,P(z)=y,è¿™å¾ˆç®€å•
3. the proof $\pi$

PCS æœ‰å¤šç§,æ¯”å¦‚ [FRI](https://drops.dagstuhl.de/opus/volltexte/2018/9018/pdf/LIPIcs-ICALP-2018-14.pdf) or Dark'20 or Dory'20 .ä½†æ˜¯ KZG ä»ç„¶æ˜¯ç›®å‰å®è·µä¸­**ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„ PCS æ–¹æ¡ˆ**.å…¶ç‰¹ç‚¹å¦‚ä¸‹

1. åŸºäº Pairing å®ç°
2. Proof size æ˜¯å¸¸é‡ (ä¸€ä¸ªæ¤­åœ†æ›²çº¿ç¾¤å…ƒç´ )
3. éªŒè¯æ—¶é—´æ˜¯å¸¸é‡ (ä¸¤æ¬¡ pairing æ“ä½œ)

å…¶ä¸­ç‰¹æ€§ 2 ä¸ 3 å¯¼è‡´å¯ä»¥å°†å…¶æ„é€ æˆä¸€ä¸ª SNARK æ–¹æ¡ˆ.SNARK çš„å…¨ç§°æ˜¯ Succinct Non-interactive  Argument of Knowledge:ç®€æ´éäº¤äº’å¼çŸ¥è¯†è®ºè¯.

SNARK è¦æ±‚ 1.size of proof=O(log(d)) 2.time of Verification =O(log(d)),d ä¸º degree of Polynomial.

è¿›è€Œå¯ä»¥å°† KZG åº”ç”¨åœ¨é›¶çŸ¥è¯†è¯æ˜ç³»ç»Ÿå¦‚ ZK-SNARK ä¸­.

## **3.è®¡ç®—å¤šé¡¹å¼çš„æ‰¿è¯º C**

åœ¨è®¡ç®—ä¹‹å‰,é¦–å…ˆä»‹ç»ä¸¤ä¸ªæ¦‚å¿µ

### **3.1 æ¤­åœ†æ›²çº¿(****EC****)**

è¿™é‡Œåªç®€å•æä¸€ä¸‹æ¤­åœ†æ›²çº¿,æ›´å¤šç»†èŠ‚å¯å‚è€ƒé˜…è¯» [basic  elliptic curve cryptography series](https://andrea.corbellini.name/2015/05/17/elliptic-curve-cryptography-a-gentle-introduction/).

å‡è®¾$\mathbb{G}$æ˜¯ç”±æ¤­åœ†æ›²çº¿ç‚¹æ„æˆçš„ç¾¤,g æ˜¯$\mathbb{G}$çš„ç”Ÿæˆå…ƒ.

ç”¨ç¬¦å·[x]è¡¨ç¤º$g^x$.ç”±äº**æ¤­åœ†æ›²çº¿çš„****ç¦»æ•£å¯¹æ•°****éš¾é¢˜**,ç»™å®š g ä¸[x],**ä½†æ— æ³•é€†æ¨å‡º x.**

### **3.2 Trusted Setup**

å¯¹å¤šé¡¹å¼è¿›è¡Œæ‰¿è¯º,éœ€è¦ä¸€ä¸ªä¸å¤šé¡¹å¼ç³»æ•°æ•°é‡ä¸€æ ·é•¿çš„ structured reference stringï¼ˆSRSï¼‰ã€‚è¯¥å­—ç¬¦ä¸²å¿…é¡»æŒ‰ç…§æŒ‡å®šçš„æ–¹å¼ç”Ÿæˆï¼Œå¹¶æä¾›ç»™ä»»ä½•å¸Œæœ›æ‰¿è¯ºå¤šé¡¹å¼çš„å‚ä¸æ–¹ã€‚ç”Ÿæˆè¿‡ç¨‹ä¼šäº§ç”Ÿä¸€ä¸ªç§˜å¯†å€¼ s,ä¹Ÿç§°ä¸º trapdoor æˆ–è€… toxic wasteï¼‰ï¼Œå¿…é¡»å°† s å…¶ä¸¢å¼ƒã€‚æ¢å¥è¯è¯´ï¼Œç”Ÿæˆå‚è€ƒå­—ç¬¦ä¸²çš„ä»»ä½•ä¸€æ–¹éƒ½çŸ¥é“ä¸€ä¸ªä¿¡æ¯ç‰‡æ®µï¼Œè¯¥ä¿¡æ¯å¯ä»¥ç ´åå¤šé¡¹å¼æ‰¿è¯ºæ–¹æ¡ˆçš„ binding æ€§è´¨ï¼Œä»è€Œç ´åä½¿ç”¨è¯¥æ‰¿è¯ºæ–¹æ¡ˆçš„ä»»ä½•è¯æ˜ç³»ç»Ÿçš„æ­£ç¡®æ€§ã€‚ç”Ÿæˆè¿™æ ·çš„ SRS è¿‡ç¨‹è¢«ç§°ä¸º**å¯ä¿¡è®¾ç½®ï¼ˆtrusted setup).**

è®¾ D æ˜¯å¸Œæœ›æ”¯æŒæ‰¿è¯ºçš„å¤šé¡¹å¼ P(x)çš„æœ€é«˜æ¬¡æ•°ä¸Šç•Œ, SRS =$(g, g^s , g^{s^2} , . . . , g^{s^D})$.

ç›®å‰ä¸»æµæ˜¯é€šè¿‡ **Ceremony** ç”Ÿæˆ SRS,å…³äº **Ceremony** çš„è¯¦ç»†ç»†èŠ‚å¯å‚è€ƒ [https://mirror.xyz/privacy-scaling-explorations.eth/naTdx-u7kyirczTLSAnWwH6ZdedfTQu1yCWQj1m_n-E](https://mirror.xyz/privacy-scaling-explorations.eth/naTdx-u7kyirczTLSAnWwH6ZdedfTQu1yCWQj1m_n-E)

Ceremony çš„æ€æƒ³ä¸ MPC ç±»ä¼¼ï¼Œè®© N åå‚ä¸è€…ç”Ÿæˆè‡ªå·±çš„ç§˜å¯†ï¼Œå¹¶æŒ‰é¡ºåºå°†å…¶æ·»åŠ åˆ°ä¸»ç§˜å¯†ä¸­ã€‚åªè¦æœ‰ä¸€ä¸ªå‚ä¸è€…ä¸æ³„éœ²ç§˜å¯†ï¼Œé‚£ä¹ˆä¸»ç§˜å¯†å°±æ˜¯å®‰å…¨çš„ã€‚ä¸»ç§˜å¯†çš„ç”Ÿæˆè¿‡ç¨‹è¢«ç§°ä¸º Ceremony.

å¯è¿›å…¥ [https://ceremy.ethereum.org](https://ceremy.ethereum.org) å‚ä¸ä»¥å¤ªåŠç¤¾åŒºç»„ç»‡çš„ KZG Ceremony çš„ç”Ÿæˆè¿‡ç¨‹,æˆä¸ºå…¶ä¸­ä¸€åè´¡çŒ®è€…!

### **3.3 combine Trusted Setup and EC**

- Trusted Setup é˜¶æ®µç”Ÿæˆ SRS=($[s^0],[s^1],[s^2]...[s^n]$),n ä¸º P(x)çš„ degree.ç„¶åå°† s ä¸¢å¼ƒã€‚ä»»ä½•äººéƒ½å¯ä»¥è®¿é—® SRSï¼Œä½†æ˜¯**æ— æ³•è·å¾— s æœ¬èº«**.
- é€šè¿‡ SRS é‡æ–°æ„é€ å¤šé¡¹å¼ P(x)ä¸º[P(s)],è€Œä¸ä¼šæš´éœ² s ä¸å¤šé¡¹å¼æœ¬èº«

  â€‹                      $\left[ P(s)\right] = \left[ \sum_{i=0}^n c_i s^i \right] = \sum_{i=0}^n c_i \left[ s^i \right]$

ä¸Šå¼ä¸­ï¼Œç”¨ç§˜å¯† s æ›¿æ¢è‡ªå˜é‡ X,å¾—åˆ° P(s):å› ä¸ºè‡ªå˜é‡ x å¯ä»¥è¡¨ç¤ºä¸ºä»»ä½•å€¼,.è¿™ä¸å½±å“å¤šé¡¹å¼æœ¬èº«.è¿›è€Œå¾—åˆ°æ‰¿è¯º C=[P(s)]

## **4.è®¡ç®— proof**

æˆ‘ä»¬éœ€è¦ proof $\pi$è¯æ˜ P(z)=v.æ„é€ $\pi$å‰å…ˆå¼•å…¥ä¸€äº› polynomial math.

> **P(x)çš„é›¶ç‚¹ä¸º mï¼Œå³ P(m)=0.é‚£ä¹ˆ P(x)ä¸€å®šèƒ½æ•´é™¤ï¼ˆx-m),å³å­˜åœ¨ä¸€ä¸ªå•†å¤šé¡¹å¼ q(x).ä½¿å¾—**
>
> $$
> P(X)=(X-m)*q(x)
> $$

æƒ³è¦è¯æ˜çš„æ˜¯ **p(z)=v**,ç»“åˆä¸Šè¿° polynomial math.å¯åšå¦‚ä¸‹å˜æ¢.

p(X)-v=0 when X=z,åˆ™ p(X)-y èƒ½æ•´é™¤(X-z) ,å³$q(X)=\frac{P(X)-v}{X-z}$,å³$\pi=q(s)=\frac{P(s)-v}{S-z}$.

ä¹ŸæŠŠ q(X)ç§°ä¸º**"Witness Polynomial"**

å¯¹äº$p(s)-v= q(s)(s - z)$,ä¸èƒ½ç›´æ¥åˆ©ç”¨è¿™ä¸ªç­‰å¼,å› ä¸ºç­‰å¼ä¸­çš„**s **ä¸¤æ–¹éƒ½ä¸çŸ¥é“

**ç›´è§‰ä¸Š**,æˆ‘ä»¬å¸Œæœ›ç›´æ¥è¯æ˜ç­‰å¼ [p(s)-v] = [q(s)*(s-z)]æˆç«‹,ä»è€Œå®ŒæˆéªŒè¯.

**ç­‰å¼å·¦è¾¹:**

æ‰¿è¯ºä»…æ»¡è¶³**åŠ æ³•åŒæ€**_:_$[p(s)]+[q(s)]=[p(s)+q(s)]$,æ‰€ä»¥[p(s)-v]=[p(s)] -[v]

**ç­‰å¼å³è¾¹:**

åœ¨éªŒè¯è¿‡ç¨‹ä¸­,éªŒè¯æ–¹ä¼šæ”¶åˆ°è¯æ˜æ–¹å‘æ¥çš„[p(s)] ,åŒæ—¶éªŒè¯æ–¹è‡ªå·±å¯ä»¥è®¡ç®—[s-z]=[s]-[z]çš„å€¼

ä½†æ˜¯ç”±äºæ¤­åœ†æ›²çº¿ä¸Šä¸æ»¡è¶³ä¹˜æ³•,å³**ä¹˜æ³•****åŒæ€**:[p(s)]*[q(s)] =[p(s)*q(s)]

æ‰€ä»¥ç­‰å¼**[q(s) * (s-z)]= [q(s)]*[s-z]** å¹¶ä¸æˆç«‹,éœ€è¦å¼•å…¥**é…å¯¹ pairing**ã€‚

`å› ä¸ºæ¤­åœ†æ›²çº¿ä¸Šçš„è¿ç®—æ˜¯ä¸€ä¸ªåŠ æ³•ç¾¤ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¹˜æ³•ç¾¤ï¼Œä¹˜æ³•æ²¡æœ‰è¢«å®šä¹‰ã€‚`

> è¿™é‡Œéœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œå•ä¸ªè¿ç®—ç»“æ„å…¶å®å¹¶ä¸åŒºåˆ†åŠ æ³•ä¹˜æ³•ï¼Œa o b è¿™ä¸ª o æŠŠå®ƒç§°ä½œæˆä»€ä¹ˆéƒ½è¡Œ
> åªæ˜¯åœ¨æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿ç‚¹é›†æ„æˆä¸€ä¸ªåŠ æ³•ç¾¤ï¼ŒæŠŠå®ƒç§°ä¸ºåŠ æ³•æ˜¯æ›´ç¬¦åˆä¹ æƒ¯ã€‚
> æˆ‘ä»¬åŒºåˆ«åŠ æ³•ä¸ä¹˜æ³•ï¼Œæ¯”å¦‚ä¸¤ç§è¿ç®—çš„ä»£æ•°ç»“æ„æ¯”å¦‚ç¯ï¼ŒåŸŸã€‚
> å› ä¸ºæœ‰ä¸¤ç§è¿ç®—ï¼Œéœ€è¦åšåŒºåˆ†ï¼Œå› ä¸ºæ¶‰åŠåˆ°åˆ†é…å¾‹ï¼Œè°å¯¹è°åˆ†é…çš„é—®é¢˜ï¼Œæ‰€ä»¥ä¼šå¾ˆæ˜ç¡®çš„åŒºåˆ†åŠ æ³•ä¸ä¹˜æ³•ã€‚

## 5.Pairing

Pairing is **a bilinear mapping.**æ·±å…¥å­¦ä¹ Pairingå¯å‚è€ƒ**ã€ŠPairing for beginnersã€‹**è¿™æœ¬ä¹¦,åœ¨è¿™é‡Œåªåšç®€å•ä»‹ç».

- **bilinear**
  - Linearity:å¯¹äºæŸäº›ä¸€å…ƒå‡½æ•°,å¦‚æœè¯¥å‡½æ•°æœä»$ğ‘“(ğ‘ğ‘Ÿ_1+ğ‘ğ‘Ÿ_2)=ğ‘ğ‘“(ğ‘Ÿ_1)+ğ‘ğ‘“(ğ‘Ÿ_2)$
  - Bilinearity:å¯¹äºäºŒå…ƒå‡½æ•°,Linearity å­˜åœ¨äºæ‰€æœ‰ç»´åº¦ä¸­,å³

$$
ğ‘“(ğ‘ğ‘Ÿ_1+ğ‘ğ‘Ÿ_2,ğ‘ )=ğ‘ğ‘“(ğ‘Ÿ_1,ğ‘ )+ğ‘ğ‘“(ğ‘Ÿ_2,ğ‘ ),ğ‘“(ğ‘Ÿ,ğ‘ğ‘ _1+ğ‘ğ‘ _2)=ğ‘ğ‘“(ğ‘Ÿ,ğ‘ _1)+ğ‘ğ‘“(ğ‘Ÿ,ğ‘ _2)
$$

- **bilinear mapping**
  [åŒçº¿æ€§æ˜ å°„](https://zh.wikipedia.org/wiki/%E5%8F%8C%E7%BA%BF%E6%80%A7%E6%98%A0%E5%B0%84)æ˜¯ä¸€ä¸ªå‡½æ•°,å®ƒä»ä¸¤ä¸ªå‘é‡ç©ºé—´çš„å…ƒç´ äº§ç”Ÿç¬¬ä¸‰ä¸ªå‘é‡ç©ºé—´çš„å…ƒç´ ,æ¯ä¸ªå‚æ•°éƒ½æ˜¯çº¿æ€§çš„.

### 5.1 about pairing

é…å¯¹æ˜¯â¼€ç§æŠ½è±¡æ“ä½œã€‚å…¶å®šä¹‰å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ æœ‰ Tate é…å¯¹ã€Weil é…å¯¹ã€Ate é…å¯¹ç­‰ç­‰â€¦â€¦ è™½ç„¶æ¯â¼€ä¸ªéƒ½é€šè¿‡ä¸åŒçš„æ“ä½œæ¥å®šä¹‰é…å¯¹,**ä½†æ˜¯Inputä¸outputçš„æ ¼å¼,pairing çš„å±æ€§éƒ½æ˜¯å›ºå®šçš„**.

#### **Input**:

![](static/LTvUbxxJ9oe9z0xoYiecoD7dn85.png)

![](static/ErfgbsD5DoFQgfxqY5VczC40nOf.png)

#### **output**ï¼š

n é˜¶ä¹˜æ³•ç¾¤$G_T$ä¸­çš„æ•´æ•°ï¼ˆæˆ–å¤æ•°)

$e(G_1,G_1)ï¼Œe(G_1,G_2)$åˆ†åˆ«æ˜¯å¯¹ç§°ä¸éå¯¹ç§°çš„ Pairing å½¢å¼ã€‚**åœ¨å®é™…ä¸­ï¼Œéå¯¹ç§° Pairing æ•ˆç‡æœ€é«˜ã€‚**

#### propertiesï¼š

- e(P, Q + R) = e(P,Q) * e(P, R)
- e(P + S, Q) = e(P,Q) * e(S, Q)
- $e(aP, bR) = e(P,R)^{ab} = e(P, bR)^a = e(aP, R)^b = e(bP, aR)$(bilinear)
- e(P, Q) â‰  1 (non-degeneracy property)

### 5.2 Pairing examples

#### 1.e(x, y) = 2Ë£Ê¸

ä¾‹: è¯·ä¸¾ä¾‹åœ¨å®æ•°åŸŸä¸­ e(x, y) = 2Ë£Ê¸ æ˜¯åŒçº¿æ€§å‡½æ•°.

- e(3, 4 + 5) = 2Â³Ë™â¹ = 2Â²â·
- e(3, 4) * e(3, 5) = 2Â³Ë™â´ * 2Â³Ë™âµ = 2Â¹Â² * 2Â¹âµ = 2Â²â·.
- é€šè¿‡ pairing è¯æ˜çŸ¥é“ xÂ² - x - 42 = 0 çš„è§£, ç„¶è€Œå¹¶ä¸é€éœ²è¿™ä¸ªè§£çš„å…·ä½“æ•°å€¼.

å¦‚æœ $e(G, G)^k = 1$ æˆç«‹, é‚£ä¹ˆ k å¿…é¡»ä¸º 0 æˆ–è€…ç›®æ ‡ç¾¤çš„å€æ•°.

å¦‚æœå­˜åœ¨ $e(G, G)^{(xÂ² - x - 42)}$, å¯ä»¥ç¡®å®šåŸå§‹äºŒæ¬¡æ–¹ç¨‹å¼æˆç«‹. ä½¿ç”¨åŒçº¿æ€§æ€§é‡å†™æ–¹ç¨‹ $e(G, G)^{(xÂ²)} â‹… e(G, G)^{(-x)}â‹… e(G, G)^{(-42)}= 1$.è¿›ä¸€æ­¥,e(xG, xG) â‹… e(xG, -G) â‹… e(G, -42G) = 1.

å› æ­¤åªéœ€è¦æä¾› xG çš„å€¼. åŒæ—¶ç”±äºæ¤­åœ†æ›²çº¿çš„ç¦»æ•£å¯¹æ•°é—®é¢˜, ä» xG åæ¨å› x æ˜¯å›°éš¾çš„.

#### 2.**è§£å†³ Diffie-Hellman éš¾é¢˜**

#### 3.**BLS**ç­¾å

## 6.**KZG**

å›åˆ°KZGéƒ¨åˆ†

$\mathbb{G}_1,\mathbb{G}_2$åˆ†åˆ«æ˜¯åŒä¸€æ¤­åœ†æ›²çº¿çš„ä¸¤ä¸ªå­ç¾¤.g æ˜¯å­ç¾¤$\mathbb{G}_1$çš„ç”Ÿæˆå…ƒ,h æ˜¯å­ç¾¤$\mathbb{G}_2$çš„ç”Ÿæˆå…ƒ

ç”Ÿæˆå…ƒçš„é€‰æ‹©é€šå¸¸åœ¨ trusted Setup é˜¶æ®µé€‰æ‹©$[x]_1=g^x,[x]_2=h^x.$

define pairing e: $\mathbb{G}_1 \times \mathbb{G}_2 \rightarrow \mathbb{G}_T$,å¯¹äºç§˜å¯† s ä¹Ÿç›¸åº”æœ‰ä¸¤ä¸ªåˆ†å¸ƒ$[s^i]_1,[s^i]_2$.å³SRS

åŸæ¥è¦éªŒè¯çš„ç­‰å¼ï¼š$q(s)Â·(s-z)=p(s)-v$   **=>**   $Ï€_1Â·[s-z]_2=C_1-[v]_1$

åˆ†å¸ƒé›†1: $[s_i]_1=g^{s_i}$ï¼Œå¯¹åº”ç”Ÿæˆå…ƒä¸ºgã€‚è®¡ç®—Ï€ã€Cã€$[v]_1$

åˆ†å¸ƒé›†2: $[s_i]_2=h^{s_i}$ï¼Œå¯¹åº”ç”Ÿæˆå…ƒä¸ºhã€‚è®¡ç®—$[s-z]_2$               

éªŒè¯è€…éªŒè¯ç­‰å¼ï¼š$e(Ï€ï¼Œ[s-z]_2)\stackrel{?}{=} e(C-[v]_1,h)$

ç®€å•ç†è§£è¿™ä¸ªç­‰å¼ï¼š$e(Ï€ï¼Œ[s-z]_2ï¼‰=e(g^{q(s)}ï¼Œh^{s-z}) =e(g,h)^{q(s)Â·(s-z)}$

$eï¼ˆC-[v]_1,h)     =e  (g^{C-v},h)        =e(g,h)^{C-v}$

> [x]g ä¸ g^x è¡¨è¿°å½¢å¼ä¸åŒï¼Œæœ¬è´¨ä¸Šæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚
> a o b =c
> å¦‚æœç¾¤è¿ç®—å®šä¹‰ä¸ºåŠ æ³•ï¼Œå°±ä½¿ç”¨[x]g è¿™ç§å½¢å¼
> å¦‚æœç¾¤è¿ç®—å®šä¹‰ä¸ºä¹˜æ³•ï¼Œå°±ä½¿ç”¨ g^x è¿™ç§å½¢å¼

ç”¨é»‘ç›’æ¥ç†è§£è¿™ä¸ªç­‰å¼çš„è¯ï¼Œå°±ç­‰ä»·äºåœ¨$G_T$ç¾¤ä¸­å»éªŒè¯ä¸‹é¢ä¹˜æ³•çš„æˆç«‹

$$
[q(s).(s-z)]_T=[p(s)-y]_T
$$

Verifier å¦‚ä½•è¿›è¡ŒéªŒç®—ï¼š

- _prover å‘é€_$\pi=[q(s)]$,C,v
- Verifier è‡ªå·±é€‰æ‹©çš„ z,æ ¹æ®åŠ æ³•åŒæ€,Verifier å¯ä»¥è®¡ç®—_[s -z]â‚‚=[s]â‚‚ - [z]â‚‚_
- _g,h_ is public,**pairing function is public.**

### KZG **å®Œæ•´è¿‡ç¨‹ï¼š**

1. é€šè¿‡ Trusted setup, äº§ç”Ÿ SRS:**[sâ±]â‚**,  **[sâ±]â‚‚**.
2. Prover ä½¿ç”¨_[sâ±]â‚_,å¯¹å¤šé¡¹å¼ P(x)è¿›è¡Œ commit,å¾—åˆ° **C** = _[p(s)]â‚_,  å‘é€ç»™ Verifier.
3. Verifier é€‰æ‹©æŒ‘æˆ˜ç‚¹_z _âˆˆ {0,...,_p_âˆ’1}
4. Prover å‘é€ **Ï€ ã€y** ç»™ Verifier:
5. Verifier æ£€æŸ¥ç­‰å¼: _e(Ï€, [s -z]â‚‚) = e(C -[v]â‚, H)
   __â€”_ if the equation holds, the verifier accepts the proof
   _â€”_ if the equation does not hold, the verifier rejects the proof

### KZG åˆ†æ

å¯¹ KZG çš„ Corretness Binding hiding åˆ†åˆ«åˆ†æ

- Corretness

$$
e(Ï€ï¼Œ[s-z]_2)\stackrel{?}{=} e(C-[y]_1,h)
$$

ç­‰å¼å·¦è¾¹:$e(Ï€ï¼Œ[s-z]_2)=eï¼ˆg^{q(s)}ï¼Œh^{s-z}ï¼‰ =e(g,h)^{q(s)Â·(s-z)}$

ç­‰å¼å³è¾¹: $e(C-[y]_1,h)    =e  (g^{C-y},h)        =e(g,h)^{C-y}$

- hiding

å› ä¸ºæ¤­åœ†æ›²çº¿çš„ç¦»æ•£å¯¹æ•°éš¾é¢˜,æ•Œæ‰‹æ‹¿åˆ°[x]æ— æ³•å¾—åˆ° x.

- Binding

åˆ†æ Binding å‰ï¼Œéœ€è¦ä»‹ç» SDH å‡è®¾ã€‚

**Strong Diffie-Hellman(SDH)** é—®é¢˜å®šä¹‰å¦‚ä¸‹ï¼š

ç»™å®š(q+1)é•¿çš„å…ƒç»„ $(g^1,g^s,g^{s^2}...g^{s^q})$ ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡º $(g^{\frac{1}{s+x}},x),xâˆˆZ_p^*$

**SDH**å‡è®¾**å°±æ˜¯ä¸å­˜åœ¨å¤šé¡¹å¼æ—¶é—´ç®—æ³•å¯ä»¥**ä»¥**ä¸å¯å¿½ç•¥æ¦‚ç‡**è§£å†³ SDH é—®é¢˜ã€‚ä¸‹é¢ç”¨å¯¹ç§°å½¢å¼çš„ Pairing è¿›è¡Œåˆ†æ

åç»­ pairing çš„éªŒè¯éƒ½æ˜¯â€œg çš„æŒ‡æ•°ä¸Šâ€åœ¨è¿›è¡ŒéªŒè¯,ä¸ºäº†æ–¹ä¾¿èµ·è§.çœç•¥åº•æ•° g,åç»­çš„ç­‰å¼éƒ½æ˜¯åœ¨æŒ‡æ•°ä½ç½®ä¸Šè¿›è¡Œ.

åè¯æ³•,å³KZGä¸æ»¡è¶³ binding,é‚£ä¹ˆ open æ‰¿è¯º C å¯ä»¥å¾—åˆ°å€¼ v å’Œ v'ï¼Œæ‰¿è¯ºæ–¹å¿…é¡»ç¡®å®šä¸¤ä¸ªä¸åŒçš„å€¼ y å’Œ y'ï¼Œä½¿å¾—ä¸‹åˆ—ç­‰å¼æˆç«‹:

$$
q(s)âˆ’v = w(s)Â·(s âˆ’z),q(s)âˆ’v'= w'(s)Â·(s âˆ’z)
$$

å³$v' âˆ’v = (q(s)âˆ’w'(s))(s âˆ’z)$

_å› ä¸º_$vâˆ’v'\neq0$,å‡è®¾ $s\neq z$, ç­‰å¼ä¸¤è¾¹åŒæ—¶é™¤ä»¥$(vâˆ’v')Â·(sâˆ’z)$å¯å¾—:

$\frac{1}{(sâˆ’z)} = \frac{q(s)âˆ’qâ€²(s)}{(vâˆ’vâ€²)}$,å³$g^{\frac{1}{(sâˆ’z)}} = g^{\frac{q(s)âˆ’qâ€²(s)}{(vâˆ’vâ€²)}}$,è¿™è¯´æ˜æœ‰äººå¯é«˜æ•ˆè®¡ç®—å‡º$g^{\frac{1}{s-z}}$,è¿™**è¿èƒŒäº†SDHå‡è®¾**.

### æ€»ç»“:

åƒä¹‹å‰è¯´çš„é‚£æ ·,KZG æ–¹æ¡ˆçš„ Proof size æ˜¯å¸¸é‡ (ä¸€ä¸ªæ¤­åœ†æ›²çº¿ç¾¤å…ƒç´ ),éªŒè¯æ—¶é—´ä¹Ÿæ˜¯å¸¸é‡ (ä¸¤æ¬¡ pairing æ“ä½œ),è¿™æ˜¯å…¶ä¼˜ç‚¹.ä½†æ˜¯å…¶æœ€å¤§ç¼ºç‚¹æ˜¯éœ€è¦ä¸€ä¸ª Trusted Setup é˜¶æ®µ.

## 7.**Batch-KZG proofï¼šmulti proof**

ä¸Šè¿°è¿‡ç¨‹éªŒè¯äº†â¼€ä¸ªåœ¨**å•ç‚¹ä¸Š**æ±‚å€¼çš„å¤šé¡¹å¼ã€‚ä½†å¦‚æœæƒ³è¯æ˜â¼€ä¸ªå¤šé¡¹å¼ä¸Šåœ¨**å¤šç‚¹**ä¸Šçš„å€¼ï¼Œå°±å¿…é¡»â¼€æ¬¡â¼œâ¼€æ¬¡åœ°é‡å¤åŒæ ·çš„åè®® **(back and forth)**ã€‚è¿™æ˜¾ç„¶æ˜¯æ²¡æœ‰æ•ˆç‡çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦ "æ‰¹é‡ "éªŒè¯å¤šé¡¹å¼ä¸Šçš„ç‚¹ã€‚

å‡è®¾æƒ³è¯æ˜ k ä¸ªç‚¹ä¸Šçš„å€¼ï¼š

é€šè¿‡ä½¿ç”¨æ‹‰æ ¼æœ—æ—¥å¤šé¡¹å¼æ’å€¼æ³•ï¼Œæ„é€ ä¸€ä¸ªç»è¿‡ä¸Šè¿° k ä¸ªç‚¹å¯¹çš„ k-1 æ¬¡å¤šé¡¹å¼

n+1 ä¸ªåæ ‡å¯¹çš„å½¢å¼ å¯ä»¥å”¯ä¸€çš„æ¢å¤å‡ºä¸€ä¸ªå¤šé¡¹å¼

![](static/EtQDbXyqrokYp6x860wc9F6unBf.png)

**åŸå¤šé¡¹å¼ P(x)**ä¸**æ„é€ çš„ I(x)**éƒ½ç»è¿‡ k ä¸ªç‚¹å¯¹ï¼Œæ‰€ä»¥å¤šé¡¹å¼ P(x)-I(x)=0 åœ¨å¦‚ä¸‹ç‚¹ä¸Šæ»¡è¶³

![](static/FHTIbRearoiiPixkU86c4YMvnbg.png)

å³å¤šé¡¹å¼èƒ½å¤Ÿæ•´é™¤

![](static/Cy6zbf5ujo3Hb3xam0vcWj8Uncd.png)

å®šä¹‰ä¸€ä¸ª zero polynomial:

![](static/GsAnbEDBSoW6Z0xOokpcT0xwn1d.png)

åˆ™ä¸‹å¼æˆç«‹

![](static/GjIybT7UGoINJgxq86oc5xMVn5d.png)

å®šä¹‰ kate multiproof for the evaluation of these pointsï¼š

![](static/LkOXbbD7volPc9x5BTmcirVrnNc.png)

éªŒè¯è¿‡ç¨‹å¦‚ä¸‹ï¼š

- Verifier é€šè¿‡ k ä¸ª points(z,y)è®¡ç®— Z(x)å’Œ I(x)
- Verifier è®¡ç®—$[Z(s)]_2,ï¼»I(s)]_1$
- Verifier éªŒè¯ç­‰å¼$e(\pi,[Z(s)]_2) ï¼e(C-[I(s)]_1,H)$æ˜¯å¦æˆ

## 8.KZG in ZK-Rollup

åœ¨ zk-rollups çš„æƒ…å†µä¸‹,æƒ³è¯æ˜å‘ç”Ÿåœ¨ L2 ä¸Šçš„ä¸€äº›è®¡ç®—æ˜¯æœ‰æ•ˆçš„ã€‚ç®€å•æ¥è®²ï¼Œå‘ç”Ÿåœ¨ L2 ä¸Šçš„è®¡ç®—å¯é€šè¿‡ç§°ä¸ºâ€œ witness ç”Ÿæˆâ€çš„è¿‡ç¨‹è¡¨ç¤ºä¸ºäºŒç»´çŸ©é˜µã€‚ç„¶åå¯ä»¥ç”¨å¤šé¡¹å¼åˆ—è¡¨æ¥è¡¨ç¤ºçŸ©é˜µ - æ¯åˆ—éƒ½å¯ä»¥ç¼–ç ä¸ºå…¶è‡ªå·±çš„ä¸€ç»´å‘é‡ã€‚ç„¶åï¼Œè®¡ç®—çš„æœ‰æ•ˆæ€§å¯ä»¥è¡¨ç¤ºä¸ºè¿™äº›å¤šé¡¹å¼ä¹‹é—´å¿…é¡»ä¿æŒçš„ä¸€ç»„æ•°å­¦å…³ç³»ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå‰ä¸‰åˆ—åˆ†åˆ«ç”±å¤šé¡¹å¼ a(x)ã€b(x) ä»¥åŠ c(x) è¡¨ç¤ºï¼Œå¯èƒ½éœ€è¦å…³ç³» a(x)â‹…b(x)âˆ’c(x)=0 ä¿æŒã€‚å¤šé¡¹å¼ï¼ˆä»£è¡¨è®¡ç®—ï¼‰æ˜¯å¦æ»¡è¶³è¿™äº›â€œæ­£ç¡®æ€§çº¦æŸâ€å¯é€šè¿‡åœ¨ä¸€äº›éšæœºç‚¹è¯„ä¼°å¤šé¡¹å¼æ¥ç¡®å®šã€‚å¦‚æœâ€œæ­£ç¡®æ€§çº¦æŸâ€åœ¨è¿™äº›éšæœºç‚¹ä¸Šå¾—åˆ°äº†å…·ä½“çš„æ»¡è¶³ï¼Œåˆ™ä¸€åéªŒè¯è€…å¯ä»¥éå¸¸é«˜çš„æ¦‚ç‡æ–­è¨€è®¡ç®—æ˜¯æ­£ç¡®çš„ã€‚

å¾ˆè‡ªç„¶åœ°çœ‹åˆ°åƒ KZG è¿™æ ·çš„å¤šé¡¹å¼æ‰¿è¯ºæ–¹æ¡ˆï¼Œæ˜¯å¦‚ä½•ç›´æ¥æ’å…¥åˆ°è¿™ä¸ªèŒƒå¼ä¸­çš„ï¼šrollup å°† commit to ä¸€ç»„å¤šé¡¹å¼ï¼Œå®ƒä»¬ä¸€èµ·ä»£è¡¨è®¡ç®—ã€‚ ç„¶åï¼ŒéªŒè¯è€…å¯è¦æ±‚å¯¹ä¸€äº›éšæœºç‚¹è¿›è¡Œè¯„ä¼°ï¼Œä»¥æ£€æŸ¥æ­£ç¡®æ€§çº¦æŸæ˜¯å¦æˆç«‹ï¼Œä»è€ŒéªŒè¯å¤šé¡¹å¼è¡¨ç¤ºçš„è®¡ç®—æ˜¯å¦æœ‰æ•ˆã€‚

![](static/WFhObAEPnoiu9ex8c8wcMZwPn4e.png)

æœ€åæ„Ÿè°¢@Kurt-Pançš„æŒ‡å¯¼ä¸å»ºè®®

## å‚è€ƒæ–‡ç« 

[Understanding KZG10 Polynomial Commitments (taoa.io)](https://taoa.io/posts/Understanding-KZG10-Polynomial-Commitments)

[Kate Commitments: A Primer - HackMD](https://hackmd.io/@tompocock/Hk2A7BD6U)

[Dankrad Feist's kzg commitment post](https://dankradfeist.de/ethereum/2020/06/16/kate-polynomial-commitments.html)

[https://blog.subspace.network/kzg-polynomial-commitments-cd64af8ec868](https://blog.subspace.network/kzg-polynomial-commitments-cd64af8ec868)

[Understanding KZG10 Polynomial Commitments](https://taoa.io/posts/Understanding-KZG10-Polynomial-Commitments)

[Committing to lunch (taoa.io)](https://taoa.io/posts/Committing-to-lunch)

book:Proof,argument and zero knowledge

KZGåŸå§‹è®ºæ–‡
